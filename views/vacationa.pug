extends layout
block content
 mixin ddl(year)
  for t in year
   option(value=t+543)=t+543
 mixin tbody(tbl)
  tbody
   -var i=0
   while i<=2
    tr(class=i+1)
     td=i+1
     td="test1"
     td="test1"
     td="test1"+i++
 .container     
  h2(style="margin:0 0 15px 15px")='ตั้งค่าวันหยุดประจำปี'
   select(style="margin-left: 35px; font-size: 16px")
    +ddl(parms.yearlist)
  span.col.col-lg-2
   input.ava(type="text" placeholder="Title...")
   span.addBtn='ADD'
   .input-group.date
    input.form-control.datepickera(type='text' readonly placeholder="วันหยุดออฟฟิส...")
    .input-group-addon.picka
     span.fa.fa-building
   .input-group.date
    input.form-control.datepickerb(type='text' readonly placeholder="วันหยุดหน้างาน...")
    .input-group-addon.pickb
     span.fa.fa-home
  span.col.col-lg-10
   table.table
    thead
     tr
      td.col.col-sm-2="ลำดับ"
      td.col.col-sm-2="วันสำคัญ"
      td.col.col-sm-2="ออฟฟิส"
      td.col.col-sm-2="หน้างาน"
    +tbody(parms.tbl)
 style.
  .ava {
      margin: 0 0 5px 0; 
      width: 181px;
      position:relative;
  }
  .addBtn {
      padding: 8px 8px 8px 8px;
      margin: 0 0 0 5px;
      cursor: pointer;
      height: 32px;
      background-color: #b5daf9;
      align:center;
  }
  tr.stb:hover {
    cursor: pointer;
    background-color: #dfdce9;
  }
 script.
  $(document).ready(function(){
    $('.datepickera').datepicker({
      ignoreReadonly: true,
      format: 'dd/MM/yyyy',
      todayHighlight: true
    })
    $('.datepickerb').datepicker({
      ignoreReadonly: true,
      format: 'dd/MM/yyyy',
      todayHighlight: true
    })
    $('.datepickera').datepicker().on('changeDate',function(e) {
      $('.datepickera').datepicker('hide')
      $('.datepickerb').datepicker('setDate',$('.datepickera').datepicker('getDate'))
      $('.datepickerb').datepicker('show')
    })
    $('.datepickerb').datepicker().on('changeDate',function(e) {
      $('.datepickerb').datepicker('hide')
    })
    $(document).on("click", ".picka", function() {
      $('.datepickera').datepicker('show')
    })
    $(document).on("click", ".pickb", function() {
      $('.datepickerb').datepicker('show')
    })
    $(document).on("click", ".addBtn", function() {
      moment.updateLocale('th', {
      months : ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม","สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"],
      weekdays : ["วันอาทิตย์", "วันจันทร์", "วันอังคาร", "วันพุธ", "วันพฤหัส", "วันศุกร์", "วันเสาร์"]
    })
      var dtitle = $('.ava').val(),
      doffice = $('.datepickera').datepicker('getDate').getTime(),
      dsite = $('.datepickerb').datepicker('getDate').getTime(),
      lastline = parseInt($('tbody').find('tr:last-child').find('td:first-child').text())+1,
      addElement
      if (dtitle && doffice && dsite) {
        addElement = '<tr class="stb">\
        <td>'+lastline+'</td>\
        <td>'+dtitle+'</td>\
        <td>'+moment(doffice).format('ddddที่ D MMMM')+' '+ (parseInt(moment(doffice).year())+543) +'</td>\
        <td>'+moment(dsite).format('ddddที่ D MMMM')+' '+ (parseInt(moment(dsite).year())+543) +'</td>\
        </tr>'
        $('tbody').append(addElement)
      }
    })
  })
 script(src="js/bootstrap-datepicker.min.js")
 script(src="js/moment.min.js")
 link(rel='stylesheet' , href='css/bootstrap-datepicker.min.css')
